import{_ as i,c as s,o as a,aA as t}from"./chunks/framework.D9FzpcLH.js";const u=JSON.parse('{"title":"Build Options","description":"","frontmatter":{},"headers":[],"relativePath":"install.md","filePath":"install.md","lastUpdated":null}'),n={name:"install.md"};function l(o,e,r,h,p,d){return a(),s("div",null,[...e[0]||(e[0]=[t(`<h1 id="Build-Options" tabindex="-1">Build Options <a class="header-anchor" href="#Build-Options" aria-label="Permalink to &quot;Build Options {#Build-Options}&quot;">​</a></h1><p>To make customization of the build options easier we have the <code>CNPreferences.jl</code> package to generate the <code>LocalPreferences.toml</code> which is read by the build script to determine which build option to use. CNPreferences.jl will also enforce that Julia is restarted for changes to take effect.</p><h2 id="Default-Build-jlls" tabindex="-1">Default Build (jlls) <a class="header-anchor" href="#Default-Build-jlls" aria-label="Permalink to &quot;Default Build (jlls) {#Default-Build-jlls}&quot;">​</a></h2><p>cuNumeric.jl is not registered yet. The easiest way to install is using <code>Pkg.develop</code>. cuNumeric.jl leverages <a href="https://github.com/JuliaPackaging/Yggdrasil" target="_blank" rel="noreferrer">Binary Builder</a> for many of its dependencies.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Pkg; Pkg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">develop</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(url </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;https://github.com/JuliaLegate/cuNumeric.jl&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>If you previously used a custom build or conda build and would like to revert back to using prebuilt JLLs, run the following command in the directory containing the Project.toml of your environment.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">julia </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">project </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;using CNPreferences; CNPreferences.use_jll_binary()&#39;</span></span></code></pre></div><p><code>CNPreferences</code> is a separate module so that it can be used to configure the build settings before <code>cuNumeric.jl</code> is added to your environment. To install it separately run</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Pkg; Pkg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(url </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;https://github.com/JuliaLegate/cuNumeric.jl&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, subdir</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;lib/CNPreferences&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>By default, this will also revert any LegatePreferences you have set. It will revert Legate.jl to use JLLs. You can disable this behavior with <code>transitive = false</code> in the <code>use_jll_binary()</code> function.</p><h2 id="Developer-mode" tabindex="-1">Developer mode <a class="header-anchor" href="#Developer-mode" aria-label="Permalink to &quot;Developer mode {#Developer-mode}&quot;">​</a></h2><div class="warning custom-block github-alert"><p class="custom-block-title">This gives the most flexibility in installs. It is meant for developing on cuNumeric.jl. By default, this does not set any LegatePreferences.</p><p></p></div><p>We support using a custom install version of cuPyNumeric. See <a href="https://docs.nvidia.com/cupynumeric/latest/installation.html" target="_blank" rel="noreferrer">https://docs.nvidia.com/cupynumeric/latest/installation.html</a> for details about different install configurations, or building cuPyNumeric from source.</p><p>We require that you have the cuda driver <code>libcuda.so</code> on your path, cuda runtime <code>libcudart.so</code>, g++ capable compiler of C++ 20, and a recent version CMake &gt;= 3.26.</p><p>To use developer mode,</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">julia </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">project </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;using CNPreferences; CNPreferences.use_developer_mode(; wrapper_branch=&quot;main&quot;, use_cupynumeric_jll=true, cupynumeric_path=nothing)&#39;</span></span></code></pre></div><p>This will clone <a href="https://github.com/JuliaLegate/cunumeric_jl_wrapper" target="_blank" rel="noreferrer">cunumeric_jl_wrapper</a> into cuNumeric.jl/deps and build from src. By default <code>use_cupynumeric_jll</code> will be set to true and <code>wrapper_branch</code> will be set to &quot;main&quot;. However, you can set a custom branch and/or use a custom path of cupynumeric. By using disabling <code>use_cupynumeric_jll</code>, you can set <code>cupynumeric_path</code> to your custom install.</p><p>cuNumeric.jl depends on <a href="https://github.com/JuliaLegate/Legate.jl" target="_blank" rel="noreferrer">Legate.jl</a>. Developer mode by default is not transitive to LegatePreferences. This means setting cuNumeric.jl to devloper mode has no impact on Legate.jl. To have both libraries on developer mode, you need to set Legate preferences manually.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">julia </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">project </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;using LegatePreferences; LegatePreferences.use_developer_mode(; wrapper_branch=&quot;main&quot;, use_legate_jll=true, legate_path=nothing)&#39;</span></span></code></pre></div><p>LegatePreferences has similar kwargs and behavior as CNPreferences. This will clone <a href="https://github.com/JuliaLegate/legate_jl_wrapper" target="_blank" rel="noreferrer">legate_jl_wrapper</a>. By default <code>use_legate_jll</code> is set to true and <code>wrapper branch</code> is set to &quot;main&quot; You can disable the jll and set a custom legate install with <code>legate_path</code>.</p><h2 id="Link-Against-Existing-Conda-Environment" tabindex="-1">Link Against Existing Conda Environment <a class="header-anchor" href="#Link-Against-Existing-Conda-Environment" aria-label="Permalink to &quot;Link Against Existing Conda Environment {#Link-Against-Existing-Conda-Environment}&quot;">​</a></h2><div class="warning custom-block github-alert"><p class="custom-block-title">This feature is not passing our CI currently. Please use with caution. We are failing to currently match proper versions of .so libraries together. Our hope is to get this functional for users already using cuPyNumeric within conda.</p><p></p></div><p>Note, you need conda &gt;= 24.1 to install the conda package. More installation details are found <a href="https://docs.nvidia.com/cupynumeric/latest/installation.html" target="_blank" rel="noreferrer">here</a>.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># with a new environment</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">conda</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> create</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> myenv</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> conda-forge</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> legate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cupynumeric</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># into an existing environment</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">conda</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> conda-forge</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> legate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cupynumeric</span></span></code></pre></div><p>Once you have the conda package installed, you can activate here.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">conda</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> activate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [conda-env-with-cupynumeric]</span></span></code></pre></div><p>To update <code>LocalPreferences.toml</code> so that a local conda environment is used as the binary provider for cupynumeric run the following command. <code>conda_env</code> should be the absolute path to the conda environment (e.g., the value of CONDA_PREFIX when your environment is active). For example, this path is: <code>/home/JuliaLegate/.conda/envs/cunumeric-gpu</code>.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">julia </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">project </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;using CNPreferences; CNPreferences.use_conda(&quot;&lt;env-path&gt;&quot;)&#39;</span></span></code></pre></div><p>By default, this will also revert any LegatePreferences you have set. It will revert Legate.jl to use JLLs. You can disable this behavior with <code>transitive = false</code> in the <code>use_conda()</code> function.</p>`,29)])])}const k=i(n,[["render",l]]);export{u as __pageData,k as default};
